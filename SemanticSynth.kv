#:kivy 1.0

BoxLayout:
    orientation: 'vertical'
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Sine volume'
            Slider:
                id: sin
                min: 0
                max: 1
                step: 0.01
                value: 1
                orientation: 'horizontal'
                on_touch_move: app.my_synth.osc_1_mix = self.value

            Label:
                text: str(sin.value)
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Saw volume'
            Slider:
                id: saw
                min: 0
                max: 1
                step: 0.01
                value: 0
                orientation: 'horizontal'
                on_touch_move: app.my_synth.osc_3_mix = self.value

            Label:
                text: str(saw.value)

    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Square volume'
            Slider:
                id: sq
                min: 0
                max: 1
                step: 0.01
                value: 0
                orientation: 'horizontal'
                on_touch_move: app.my_synth.osc_2_mix = self.value

            Label:
                text: str(sq.value)
        
            
            Label:
                text: 'Square Percent'
            Slider:
                id: sqpct
                min: 0
                max: 1
                step: 0.01
                value: 0.5
                orientation: 'horizontal'
                on_touch_move: app.my_synth.osc_2_sqpct = self.value

            Label:
                text: str(sqpct.value)
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Noise volume'
            Slider:
                id: noise
                min: 0
                max: 1
                step: 0.01
                value: 0
                orientation: 'horizontal'
                on_touch_move: app.my_synth.osc_4_mix = self.value

            Label:
                text: str(noise.value)
        
            
            Label:
                text: 'ADSR'
            BoxLayout:
                orientation: 'horizontal'
                Slider:
                    id: a
                    min: 0.0
                    max: 1.0
                    step: 0.001
                    value: 0.04
                    orientation: 'vertical'
                    on_touch_move: app.my_synth.adsr[0] = self.value
                Slider:
                    id: d
                    min: 0.0
                    max: 1.0
                    step: 0.001
                    value: 0.2
                    orientation: 'vertical'
                    on_touch_move: app.my_synth.adsr[1] = self.value
                Slider:
                    id: s
                    min: 0.0
                    max: 1.0
                    step: 0.001
                    value: 0.3
                    orientation: 'vertical'
                    on_touch_move: app.my_synth.adsr[2] = self.value
                Slider:
                    id: r
                    min: 0.0
                    max: 2.0
                    step: 0.001
                    value: 0.4
                    orientation: 'vertical'
                    on_touch_move: app.my_synth.adsr[3] = self.value
    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'Tremolo Rate'
                Slider:
                    id: trem_rate
                    min: 0
                    max: 20
                    step: 0.01
                    value: 0
                    orientation: 'horizontal'
                    on_touch_move: app.my_synth.lfo_2_freq = self.value
            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'Tremolo Depth'
                Slider:
                    id: trem_depth
                    min: 0
                    max: 10
                    step: 0.01
                    value: 0
                    orientation: 'horizontal'
                    on_touch_move: app.my_synth.lfo_2_depth = self.value
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'Vibrato Rate'
                Slider:
                    id: vib_rate
                    min: 0
                    max: 20
                    step: 0.01
                    value: 0
                    orientation: 'horizontal'
                    on_touch_move: app.my_synth.lfo_1_freq = self.value
            BoxLayout:
                orientation: 'horizontal'
                Label:
                    text: 'Vibrato Depth'
                Slider:
                    id: vib_depth
                    min: 0
                    max: 10
                    step: 0.01
                    value: 0
                    orientation: 'horizontal'
                    on_touch_move: app.my_synth.lfo_1_depth = self.value

    BoxLayout:
        orientation: 'horizontal'
        Button:
            text: 'Play sound'
            on_release: app.play_sound([sin.value, sq.value, sqpct.value, saw.value, noise.value, [a.value, d.value, s.value, r.value], trem_rate.value, trem_depth.value, vib_rate.value, vib_depth.value])
        Button:
            text: 'Load sound'
            on_release: Factory.LoadModal().open()
        Button:
            text: 'Save sound'
            on_release: Factory.SaveModal().open()


#:import Factory kivy.factory.Factory
<SaveModal@Popup>:
    title: 'Save sound'
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'What should we call this sound?'
        TextInput:
            id: sound_name
        Button:
            text: 'Submit'
            on_release: app.save_sound(sound_name.text)
            on_release: root.dismiss()

<LoadModal@Popup>:
    title: 'Load sound'
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'What sound do you want to load?'
        TextInput:
            id: sound_name2
        Button:
            text: 'Submit'
            on_release: app.load_sound(sound_name2.text)
            on_release: root.dismiss()